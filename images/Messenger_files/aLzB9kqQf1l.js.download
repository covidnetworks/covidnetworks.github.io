if (self.CavalryLogger) { CavalryLogger.start_js(["LvTEF"]); }

__d("DGWStreamSetup",["regeneratorRuntime","CompactSerializer","DGWStream","DGWStreamCallbacks","FBDGWClient","FBLogger","RequestStreamSingleChannelSingleChannelRequestStreamSerializers"],(function(a,b,c,d,e,f){"use strict";f.setupRequestStream=a;function g(a,b){var c={};a=Object.entries(a);for(var d=0;d<a.length;d++){var e=a[d],f=e[0];e=e[1];typeof e=="string"?c["XRSS-"+f]=e:typeof e=="number"&&(c["XRSN-"+f]=e.toString())}b&&(c["xrs-body"]="true");return c}var h=function(){function a(a){this.$2=!1,this.$1=a}var c=a.prototype;c.onDataReceived=function(a){var c=this;if(this.$2){b("FBLogger")("requeststream-web").warn("get data after socket closed");return}a=b("CompactSerializer").deserialize(a,b("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(a.response){a=a.response.delta;a.forEach(function(a){if(a.data)c.$1.onData(new TextDecoder("utf-8").decode(a.data.bytes));else if(a.flow_status)c.$1.onFlowStatus(a.flow_status);else if(a.termination){var d;d=(d=a.termination.message)!=null?d:"unknown termination msg";c.$1.onTermination(d)}else a.log?c.$1.onLog(a.log.message):b("FBLogger")("requeststream-web").warn("not support other delta type now")})}else b("FBLogger")("requeststream-web").warn("not support other Payload type now")};c.onError=function(a){this.$2=!0;switch(a){case b("DGWStream").StreamError.ABNORMAL_CLOSURE:this.$1.onTermination("Received error for abnormal closure");break;case b("DGWStream").StreamError.SERVER_INTERNAL_ERROR:this.$1.onTermination("Received error for internal server error");break;default:this.$1.onTermination("Received unknown error")}};c.onClose=function(a){this.$2||(a.close(),this.$2=!0,this.$1.onTermination("Client receive OnClose and Server will not send more data"))};c.onStreamMustDrain=function(a,c){!this.$2?(a.close(),this.$2=!0,this.$1.onTermination("onStreamMustDrain for RS Client: "+c)):b("FBLogger")("requeststream-web").warn("got onStreamMustDrain, but Stream has already been closed")};return a}();f.RSDGWStreamCallback=h;function a(a,c,d,e){var f,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:f=g(c,d!=null);i=new h(a);j={};e!=null&&(j=(k=e.dgwStreamOptions)!=null?k:{});m.next=6;return b("regeneratorRuntime").awrap(b("FBDGWClient")().establishDGWStream(f,"realtime",i,j));case 6:l=m.sent;return m.abrupt("return",l);case 8:case"end":return m.stop()}},null,this)}}),null);